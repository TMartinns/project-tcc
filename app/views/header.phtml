<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title><?php echo $view_title; ?></title>

    <link rel="shortcut icon" href="<?php echo IMG; ?>favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="<?php echo BOWER; ?>bootstrap/dist/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="<?php echo BOWER; ?>font-awesome/web-fonts-with-css/css/fontawesome-all.min.css"
          type="text/css">
    <link rel="stylesheet" href="<?php echo BOWER; ?>malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.min.css"
          type="text/css">
    <link rel="stylesheet" href="<?php echo BOWER; ?>EasyAutocomplete/dist/easy-autocomplete.min.css" type="text/css">
    <link rel="stylesheet" href="<?php echo CSS; ?>main.css" type="text/css">

    <?php
    echo $add_css;
    ?>
</head>

<body style="padding-top: 83px">
<div class="container-fluid">
    <div id="container">
        <nav class="navbar fixed-top navbar-expand navbar-light bg-white border shadow-lg">
            <button type="button" id="sidebarAppear" class="btn btn-outline-dark shadow">
                <i class="fas fa-bars"></i>
            </button>

            <a class="navbar-brand ml-2" href="#">
                <img id="brand" src="<?php echo IMG . DS . 'logo.png'; ?>" height="40" alt="ADUV">
            </a>

            <ul class="nav navbar-nav ml-auto">
                <li class="nav-item shadow">
                    <button type="button" class="btn btn-outline-dark">
                        <i class="fas fa-bell fa-1x"></i>
                        <span class="badge badge-primary">0</span>
                    </button>
                </li>

                <li class="nav-item dropdown ml-2 shadow">
                    <button class="btn btn-outline-dark dropdown-toggle" type="button" id="dropdownMenuButton"
                            data-toggle="dropdown">
                        <?php
                        echo Pessoa::getPrimeiroNome($this->auth->getUserId());
                        ?>
                    </button>

                    <div class="dropdown-menu dropdown-menu-right shadow-lg">
                        <div class="dropdown-header text-center">
                            <img class="rounded-circle avatar bg-dark tooltipTitle shadow-lg" src="<?php
                            $title = '';
                            $usuario = Usuario::find_by_id_pessoa($this->auth->getUserId());
                            $pessoa = Pessoa::find_by_id($usuario->id_pessoa);

                            if (is_null($usuario->imagem)) {
                                $title = 'Icon designed by Eucalyp from Flaticon';
                                $avatar = '';
                                if (is_null($pessoa->genero)) {
                                    $genero = array('man-' . mt_rand(0, 34), 'woman-' . mt_rand(0, 12));
                                    $avatar = $genero[mt_rand(0, 1)];
                                } else {
                                    $avatar = ($pessoa->genero == 'M') ? 'man-' . mt_rand(0, 34) : 'woman-' . mt_rand(0, 12);
                                }
                                echo IMG . "avatars/usuarios/$avatar";
                            } else {
                                echo UPLOADS . "usuarios/$usuario->id_pessoa/$usuario->imagem";
                            }
                            ?>" height="70" width="70" title="<?php echo $title; ?>">
                        </div>

                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item text-danger"
                           href="<?php $this->printRelativeURL('index', false); ?>/sair/">
                            <span><i class="fas fa-sign-out-alt"></i></span>
                            <span>Sair</span>
                        </a>
                    </div>
                </li>
            </ul>
        </nav>

        <?php
        echo (isset($this->menu)) ? $this->menu->getMenu() : '';
        ?>

        <div id="modalRegistraUsoVeiculo" class="modal fade" tabindex="-1">
            <div class="modal-dialog modal-sm shadow-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Registrar uso do veículo</h5>

                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body p-0">
                        <video id="qrScanner" width="100%" height="auto" style="margin-bottom: -.40rem;"></video>
                    </div>

                    <div class="modal-footer text-center">
                        <small>Posicione o QR Code próximo da câmera para que ele possa ser lido.</small>
                    </div>
                </div>
            </div>
        </div>

        <div id="modalConfirmaRegistro" class="modal fade modalSeguro" tabindex="-1">
            <div class="modal-dialog modal-sm shadow-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="card-title">Você tem certeza?</h5>
                    </div>

                    <div class="modal-body text-center">
                        <small>
                            Você está prestes a registrar que usará o veículo abaixo.
                        </small>

                        <p>
                            <img class="rounded-circle avatar bg-dark shadow-lg mt-3" width="70"
                                 height="70">
                        </p>

                        <h5 id="veiculo" title="Modelo"></h5>
                    </div>

                    <div class="modal-footer bg-white">
                        <button type="button" class="cancelar btn btn-outline-danger disabled tooltipTitle shadow"
                                title="Aguarde 3 segundos">
                            <span><i class="fas fa-thumbs-down"></i></span>
                            Não
                        </button>

                        <button type="button" id="confirmaRegistro" class="btn btn-outline-success shadow"
                                data-url="<?php echo $this->getRelativeURL('veiculos', false) . DS . 'registrarUsoVeiculo' . DS; ?>">
                            <span><i class="fas fa-thumbs-up"></i></span>
                            Sim
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="modalResultadoRegistro" class="modal fade" tabindex="-1">
            <div class="modal-dialog modal-sm shadow-lg">
                <div class="modal-content">
                    <div class="modal-body text-center text-success rounded">
                        <span><i class="far fa-check-circle fa-5x"></i></span>

                        <br/>

                        Feito!
                    </div>
                </div>
            </div>
        </div>

