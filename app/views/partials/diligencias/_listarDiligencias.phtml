<?php
$diligencias = null;
$tipoDiligencia = null;

if (isset($view_tipoDiligencia) && !empty($view_tipoDiligencia)) {
    $tipoDiligencia = $view_tipoDiligencia;
    $diligencias = Diligencia::find_all_by_id_tipo_diligencia($tipoDiligencia);
}

if (is_null($diligencias) || empty($diligencias)) {
    ?>
    <div class="alert alert-warning show">
        <h5 class="alert-heading text-center">Nenhuma diligência desse tipo foi emitida até o presente momento.</h5>
    </div>
    <?php
} else {
    ?>

    <div class="row">
        <div class="col-md-12 col-lg-12">
            <nav class="diligenciasStatus nav nav-pills justify-content-center">
                <a class="emAndamentoTab nav-link text-secondary active" data-toggle="pill"
                   href="#emAndamento<?php echo $tipoDiligencia; ?>">
                    <i class="fas fa-spinner"></i>
                    <span>Em Andamento</span>
                </a>

                <a class="emEsperaTab nav-link text-secondary" data-toggle="pill"
                   href="#emEspera<?php echo $tipoDiligencia; ?>">
                    <i class="fas fa-ban"></i>
                    <span>Em Espera</span>
                </a>

                <a class="cumpridaTab nav-link text-secondary" data-toggle="pill"
                   href="#cumprida<?php echo $tipoDiligencia; ?>">
                    <i class="fas fa-check-circle"></i>
                    <span>Cumpridas</span>
                </a>
            </nav>
        </div>
    </div>

    <div class="tab-content">
        <div class="tab-pane fade show active" id="emAndamento<?php echo $tipoDiligencia; ?>">
            <br/>

            <?php
            if (!is_null($tipoDiligencia)) {
                $this->partial('listarDiligenciasPorStatus', array(
                    'tipoDiligencia' => $tipoDiligencia,
                    'status' => 'A'
                ));
            }
            ?>
        </div>

        <div class="tab-pane fade" id="emEspera<?php echo $tipoDiligencia; ?>">
            <br/>

            <?php
            if (!is_null($tipoDiligencia)) {
                $this->partial('listarDiligenciasPorStatus', array(
                    'tipoDiligencia' => $tipoDiligencia,
                    'status' => 'E'
                ));
            }
            ?>
        </div>

        <div class="tab-pane fade" id="cumprida<?php echo $tipoDiligencia; ?>">
            <br/>

            <?php
            if (!is_null($tipoDiligencia)) {
                $this->partial('listarDiligenciasPorStatus', array(
                    'tipoDiligencia' => $tipoDiligencia,
                    'status' => 'C'
                ));
            }
            ?>
        </div>
    </div>
    <?php
}
?>
